<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>GifTastic</title>
</head>

<body>
  <!-- When user clicks on Submit button 
     else value 
            1. buttons APPENDS to page
            2. API gets 10 giphs
            3. Giphs are added to page
    if no value 
            1. alert user to input value 
            
    When user clicks on gif
            1. if gif is playing
                    stop animation
               if gif is stopped
                start animation
                 -->

  <div id="buttonHolder"></div>
  <div id="gifHolder"></div>

  <br />
  <p>Type the name of a Looney Tunes character:</p>
  <!-- input form for submit button -->
  <form action="url" method="get" accept-charset="utf-8" class="form horizontal" id="reg">
    <input name="firstname" style="width: 200px" type="text" id="inputtopics" />
    <div class="controls-actions">
      <button type="submit" id="btnsubmit">Submit</button>
    </div>
  </form>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript">
    // onclick event for submit button
    $(document).ready(function () {
      $("#btnsubmit").on("click", function (event) {
        event.preventDefault();

        if ($("#inputtopics").val().trim() == "") {
          alert("Please input a character name.");
        } else {
          let topics = $("<input/>").attr({ type: "button", name: "mybutton", value: $("#inputtopics").val().trim() });
          $("#buttonHolder").append(topics);
          getGifs($("#inputtopics").val().trim());
        }
      });

    function getGifs(looneyName) {
      var queryURL = `https://api.giphy.com/v1/gifs/search?api_key=dc6zaTOxFJmzC&limit=10&q=rating=g=${looneyName}`;

      $.ajax({
        url: queryURL,
        method: "GET"
      }).then(function (response) {
        console.log(response);
        var results = response.data;
          for (var i = 0; i < response.data.length; i++) {
          var gifDiv = $("<div class = 'item'>");
          var rating = results[i].rating;
          var p = $("<p>").text("Rating: " + rating);
          // var bit = results[i].bitly_gif_url;
          // var link = $("<a>").text(bit);
          var looneyImage=$("<img>");
            looneyImage.attr("image-still", results[i].images.fixed_height_still.url);
            looneyImage.attr("image-animate", results[i].images.fixed_height.url);
            looneyImage.attr("src",results[i].images.fixed_height_still.url);
            looneyImage.attr(("image-status", "still"));
            looneyImage.addClass("play");
            // gifDiv.prepend(link);
            gifDiv.prepend(p);
            gifDiv.prepend(looneyImage);
          // gifDiv.attr("src", queryURL);
          $("#gifHolder").prepend(gifDiv);

      $(".play").on("click", function(){
        // console.log("test play");
        var status = $(this).attr("image-status");
        if(status == "still"){
          $(this).attr("src", $(this).attr("image-animate"));
          $(this).attr("image-status", "animate");
        } else {
          $(this).attr("src", $(this).attr("image-still"));
          $(this).attr("image-status", "still");
        }
       });
      }

      }).catch(function (response) {
        alert("ERROR, nothing found, please check your input.")
      });

     

    }
    });


  </script>
</body>

</html>